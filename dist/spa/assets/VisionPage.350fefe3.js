import{a7 as be,c as de,a8 as Fe,a as b,h as c,a9 as ye,l as Y,r as w,a6 as ce,s as ve,a5 as Se,A as ke,B as xe,aa as qe,p as we,o as ze,ab as Ue,a1 as Ce,ac as Be,a3 as ne,Q as Ie,X as J,ad as Re,W as Ee,M as V,N as Pe,O as Ne,P as se,ae as H,V as fe,af as Oe,ag as Le,U as Ae,ah as De}from"./index.bd582081.js";import{b as je,h as ue}from"./format.5aaf3604.js";import{a as Te,u as $e}from"./use-dark.eb83277b.js";import{Q as Me}from"./QPage.ff6a0c7c.js";import{a as Qe}from"./axios.bf56c3c5.js";import{a as We}from"./api.52e83815.js";import{u as Ve}from"./use-quasar.eedf8ecf.js";import{_ as Xe}from"./plugin-vue_export-helper.21dcd24c.js";const Ge={...be,min:{type:Number,default:0},max:{type:Number,default:100},color:String,centerColor:String,trackColor:String,fontSize:String,rounded:Boolean,thickness:{type:Number,default:.2,validator:t=>t>=0&&t<=1},angle:{type:Number,default:0},showValue:Boolean,reverse:Boolean,instantFeedback:Boolean},K=50,pe=2*K,me=pe*Math.PI,He=Math.round(me*1e3)/1e3;var Je=de({name:"QCircularProgress",props:{...Ge,value:{type:Number,default:0},animationSpeed:{type:[String,Number],default:600},indeterminate:Boolean},setup(t,{slots:s}){const{proxy:{$q:l}}=Y(),r=Fe(t),n=b(()=>{const _=(l.lang.rtl===!0?-1:1)*t.angle;return{transform:t.reverse!==(l.lang.rtl===!0)?`scale3d(-1, 1, 1) rotate3d(0, 0, 1, ${-90-_}deg)`:`rotate3d(0, 0, 1, ${_-90}deg)`}}),u=b(()=>t.instantFeedback!==!0&&t.indeterminate!==!0?{transition:`stroke-dashoffset ${t.animationSpeed}ms ease 0s, stroke ${t.animationSpeed}ms ease`}:""),v=b(()=>pe/(1-t.thickness/2)),y=b(()=>`${v.value/2} ${v.value/2} ${v.value} ${v.value}`),k=b(()=>je(t.value,t.min,t.max)),C=b(()=>t.max-t.min),z=b(()=>t.thickness/2*v.value),E=b(()=>{const _=(t.max-k.value)/C.value,e=t.rounded===!0&&k.value<t.max&&_<.25?z.value/2*(1-_/.25):0;return me*_+e});function B({thickness:_,offset:e,color:g,cls:U,rounded:f}){return c("circle",{class:"q-circular-progress__"+U+(g!==void 0?` text-${g}`:""),style:u.value,fill:"transparent",stroke:"currentColor","stroke-width":_,"stroke-dasharray":He,"stroke-dashoffset":e,"stroke-linecap":f,cx:v.value,cy:v.value,r:K})}return()=>{const _=[];t.centerColor!==void 0&&t.centerColor!=="transparent"&&_.push(c("circle",{class:`q-circular-progress__center text-${t.centerColor}`,fill:"currentColor",r:K-z.value/2,cx:v.value,cy:v.value})),t.trackColor!==void 0&&t.trackColor!=="transparent"&&_.push(B({cls:"track",thickness:z.value,offset:0,color:t.trackColor})),_.push(B({cls:"circle",thickness:z.value,offset:E.value,color:t.color,rounded:t.rounded===!0?"round":void 0}));const e=[c("svg",{class:"q-circular-progress__svg",style:n.value,viewBox:y.value,"aria-hidden":"true"},_)];return t.showValue===!0&&e.push(c("div",{class:"q-circular-progress__text absolute-full row flex-center content-center",style:{fontSize:t.fontSize}},s.default!==void 0?s.default():[c("div",k.value)])),c("div",{class:`q-circular-progress q-circular-progress--${t.indeterminate===!0?"in":""}determinate`,style:r.value,role:"progressbar","aria-valuemin":t.min,"aria-valuemax":t.max,"aria-valuenow":t.indeterminate===!0?void 0:k.value},ye(s.internal,e))}}});function M(t,s,l,r){const n=[];return t.forEach(u=>{r(u)===!0?n.push(u):s.push({failedPropValidation:l,file:u})}),n}function X(t){t&&t.dataTransfer&&(t.dataTransfer.dropEffect="copy"),ve(t)}const Ke={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},Ye=["rejected"];function Ze({editable:t,dnd:s,getFileInput:l,addFilesToQueue:r}){const{props:n,emit:u,proxy:v}=Y(),y=w(null),k=b(()=>n.accept!==void 0?n.accept.split(",").map(o=>(o=o.trim(),o==="*"?"*/":(o.endsWith("/*")&&(o=o.slice(0,o.length-1)),o.toUpperCase()))):null),C=b(()=>parseInt(n.maxFiles,10)),z=b(()=>parseInt(n.maxTotalSize,10));function E(o){if(t.value)if(o!==Object(o)&&(o={target:null}),o.target!==null&&o.target.matches('input[type="file"]')===!0)o.clientX===0&&o.clientY===0&&ce(o);else{const x=l();x&&x!==o.target&&x.click(o)}}function B(o){t.value&&o&&r(null,o)}function _(o,x,L,A){let d=Array.from(x||o.target.files);const h=[],I=()=>{h.length!==0&&u("rejected",h)};if(n.accept!==void 0&&k.value.indexOf("*/")===-1&&(d=M(d,h,"accept",p=>k.value.some(F=>p.type.toUpperCase().startsWith(F)||p.name.toUpperCase().endsWith(F))),d.length===0))return I();if(n.maxFileSize!==void 0){const p=parseInt(n.maxFileSize,10);if(d=M(d,h,"max-file-size",F=>F.size<=p),d.length===0)return I()}if(n.multiple!==!0&&d.length!==0&&(d=[d[0]]),d.forEach(p=>{p.__key=p.webkitRelativePath+p.lastModified+p.name+p.size}),A===!0){const p=L.map(F=>F.__key);d=M(d,h,"duplicate",F=>p.includes(F.__key)===!1)}if(d.length===0)return I();if(n.maxTotalSize!==void 0){let p=A===!0?L.reduce((F,P)=>F+P.size,0):0;if(d=M(d,h,"max-total-size",F=>(p+=F.size,p<=z.value)),d.length===0)return I()}if(typeof n.filter=="function"){const p=n.filter(d);d=M(d,h,"filter",F=>p.includes(F))}if(n.maxFiles!==void 0){let p=A===!0?L.length:0;if(d=M(d,h,"max-files",()=>(p++,p<=C.value)),d.length===0)return I()}if(I(),d.length!==0)return d}function e(o){X(o),s.value!==!0&&(s.value=!0)}function g(o){ve(o),(o.relatedTarget!==null||Se.is.safari!==!0?o.relatedTarget!==y.value:document.elementsFromPoint(o.clientX,o.clientY).includes(y.value)===!1)===!0&&(s.value=!1)}function U(o){X(o);const x=o.dataTransfer.files;x.length!==0&&r(null,x),s.value=!1}function f(o){if(s.value===!0)return c("div",{ref:y,class:`q-${o}__dnd absolute-full`,onDragenter:X,onDragover:X,onDragleave:g,onDrop:U})}return Object.assign(v,{pickFiles:E,addFiles:B}),{pickFiles:E,addFiles:B,onDragover:e,onDragleave:g,processFiles:_,getDndNode:f,maxFilesNumber:C,maxTotalSizeNumber:z}}function ie(t){return(t*100).toFixed(2)+"%"}const et={...Te,...Ke,label:String,color:String,textColor:String,square:Boolean,flat:Boolean,bordered:Boolean,noThumbnails:Boolean,autoUpload:Boolean,hideUploadBtn:Boolean,disable:Boolean,readonly:Boolean},ge=[...Ye,"start","finish","added","removed"];function tt(t,s){const l=Y(),{props:r,slots:n,emit:u,proxy:v}=l,{$q:y}=v,k=$e(r,y);function C(a,m,S){if(a.__status=m,m==="idle"){a.__uploaded=0,a.__progress=0,a.__sizeLabel=ue(a.size),a.__progressLabel="0.00%";return}if(m==="failed"){v.$forceUpdate();return}a.__uploaded=m==="uploaded"?a.size:S,a.__progress=m==="uploaded"?1:Math.min(.9999,a.__uploaded/a.size),a.__progressLabel=ie(a.__progress),v.$forceUpdate()}const z=b(()=>r.disable!==!0&&r.readonly!==!0),E=w(!1),B=w(null),_=w(null),e={files:w([]),queuedFiles:w([]),uploadedFiles:w([]),uploadedSize:w(0),updateFileStatus:C,isAlive:()=>ke(l)===!1},{pickFiles:g,addFiles:U,onDragover:f,onDragleave:o,processFiles:x,getDndNode:L,maxFilesNumber:A,maxTotalSizeNumber:d}=Ze({editable:z,dnd:E,getFileInput:te,addFilesToQueue:ae});Object.assign(e,t({props:r,slots:n,emit:u,helpers:e,exposeApi:a=>{Object.assign(e,a)}})),e.isBusy===void 0&&(e.isBusy=w(!1));const h=w(0),I=b(()=>h.value===0?0:e.uploadedSize.value/h.value),p=b(()=>ie(I.value)),F=b(()=>ue(h.value)),P=b(()=>z.value===!0&&e.isUploading.value!==!0&&(r.multiple===!0||e.queuedFiles.value.length===0)&&(r.maxFiles===void 0||e.files.value.length<A.value)&&(r.maxTotalSize===void 0||h.value<d.value)),i=b(()=>z.value===!0&&e.isBusy.value!==!0&&e.isUploading.value!==!0&&e.queuedFiles.value.length!==0);xe(qe,oe);const D=b(()=>"q-uploader column no-wrap"+(k.value===!0?" q-uploader--dark q-dark":"")+(r.bordered===!0?" q-uploader--bordered":"")+(r.square===!0?" q-uploader--square no-border-radius":"")+(r.flat===!0?" q-uploader--flat no-shadow":"")+(r.disable===!0?" disabled q-uploader--disable":"")+(E.value===!0?" q-uploader--dnd":"")),j=b(()=>"q-uploader__header"+(r.color!==void 0?` bg-${r.color}`:"")+(r.textColor!==void 0?` text-${r.textColor}`:""));we(e.isUploading,(a,m)=>{m===!1&&a===!0?u("start"):m===!0&&a===!1&&u("finish")});function T(){r.disable===!1&&(e.abort(),e.uploadedSize.value=0,h.value=0,ee(),e.files.value=[],e.queuedFiles.value=[],e.uploadedFiles.value=[])}function R(){r.disable===!1&&Z(["uploaded"],()=>{e.uploadedFiles.value=[]})}function W(){Z(["idle","failed"],({size:a})=>{h.value-=a,e.queuedFiles.value=[]})}function Z(a,m){if(r.disable===!0)return;const S={files:[],size:0},N=e.files.value.filter(q=>a.indexOf(q.__status)===-1?!0:(S.size+=q.size,S.files.push(q),q.__img!==void 0&&window.URL.revokeObjectURL(q.__img.src),!1));S.files.length!==0&&(e.files.value=N,m(S),u("removed",S.files))}function G(a){r.disable||(a.__status==="uploaded"?e.uploadedFiles.value=e.uploadedFiles.value.filter(m=>m.__key!==a.__key):a.__status==="uploading"?a.__abort():h.value-=a.size,e.files.value=e.files.value.filter(m=>m.__key!==a.__key?!0:(m.__img!==void 0&&window.URL.revokeObjectURL(m.__img.src),!1)),e.queuedFiles.value=e.queuedFiles.value.filter(m=>m.__key!==a.__key),u("removed",[a]))}function ee(){e.files.value.forEach(a=>{a.__img!==void 0&&window.URL.revokeObjectURL(a.__img.src)})}function te(){return _.value||B.value.getElementsByClassName("q-uploader__input")[0]}function ae(a,m){const S=x(a,m,e.files.value,!0),N=te();N!=null&&(N.value=""),S!==void 0&&(S.forEach(q=>{if(e.updateFileStatus(q,"idle"),h.value+=q.size,r.noThumbnails!==!0&&q.type.toUpperCase().startsWith("IMAGE")){const le=new Image;le.src=window.URL.createObjectURL(q),q.__img=le}}),e.files.value=e.files.value.concat(S),e.queuedFiles.value=e.queuedFiles.value.concat(S),u("added",S),r.autoUpload===!0&&e.upload())}function re(){i.value===!0&&e.upload()}function Q(a,m,S){if(a===!0){const N={type:"a",key:m,icon:y.iconSet.uploader[m],flat:!0,dense:!0};let q;return m==="add"?(N.onClick=g,q=oe):N.onClick=S,c(J,N,q)}}function oe(){return c("input",{ref:_,class:"q-uploader__input overflow-hidden absolute-full",tabindex:-1,type:"file",title:"",accept:r.accept,multiple:r.multiple===!0?"multiple":void 0,capture:r.capture,onMousedown:ce,onClick:g,onChange:ae})}function _e(){return n.header!==void 0?n.header($):[c("div",{class:"q-uploader__header-content column"},[c("div",{class:"flex flex-center no-wrap q-gutter-xs"},[Q(e.queuedFiles.value.length!==0,"removeQueue",W),Q(e.uploadedFiles.value.length!==0,"removeUploaded",R),e.isUploading.value===!0?c(ne,{class:"q-uploader__spinner"}):null,c("div",{class:"col column justify-center"},[r.label!==void 0?c("div",{class:"q-uploader__title"},[r.label]):null,c("div",{class:"q-uploader__subtitle"},[F.value+" / "+p.value])]),Q(P.value,"add"),Q(r.hideUploadBtn===!1&&i.value===!0,"upload",e.upload),Q(e.isUploading.value,"clear",e.abort)])])]}function he(){return n.list!==void 0?n.list($):e.files.value.map(a=>c("div",{key:a.__key,class:"q-uploader__file relative-position"+(r.noThumbnails!==!0&&a.__img!==void 0?" q-uploader__file--img":"")+(a.__status==="failed"?" q-uploader__file--failed":a.__status==="uploaded"?" q-uploader__file--uploaded":""),style:r.noThumbnails!==!0&&a.__img!==void 0?{backgroundImage:'url("'+a.__img.src+'")'}:null},[c("div",{class:"q-uploader__file-header row flex-center no-wrap"},[a.__status==="failed"?c(Ie,{class:"q-uploader__file-status",name:y.iconSet.type.negative,color:"negative"}):null,c("div",{class:"q-uploader__file-header-content col"},[c("div",{class:"q-uploader__title"},[a.name]),c("div",{class:"q-uploader__subtitle row items-center no-wrap"},[a.__sizeLabel+" / "+a.__progressLabel])]),a.__status==="uploading"?c(Je,{value:a.__progress,min:0,max:1,indeterminate:a.__progress===0}):c(J,{round:!0,dense:!0,flat:!0,icon:y.iconSet.uploader[a.__status==="uploaded"?"done":"clear"],onClick:()=>{G(a)}})])]))}ze(()=>{e.isUploading.value===!0&&e.abort(),e.files.value.length!==0&&ee()});const $={};for(const a in e)Ue(e[a])===!0?Ce($,a,()=>e[a].value):$[a]=e[a];return Object.assign($,{upload:re,reset:T,removeUploadedFiles:R,removeQueuedFiles:W,removeFile:G,pickFiles:g,addFiles:U}),Be($,{canAddFiles:()=>P.value,canUpload:()=>i.value,uploadSizeLabel:()=>F.value,uploadProgressLabel:()=>p.value}),s({...e,upload:re,reset:T,removeUploadedFiles:R,removeQueuedFiles:W,removeFile:G,pickFiles:g,addFiles:U,canAddFiles:P,canUpload:i,uploadSizeLabel:F,uploadProgressLabel:p}),()=>{const a=[c("div",{class:j.value},_e()),c("div",{class:"q-uploader__list scroll"},he()),L("uploader")];e.isBusy.value===!0&&a.push(c("div",{class:"q-uploader__overlay absolute-full flex flex-center"},[c(ne)]));const m={ref:B,class:D.value};return P.value===!0&&Object.assign(m,{onDragover:f,onDragleave:o}),c("div",m,a)}}const at=()=>!0;function rt(t){const s={};return t.forEach(l=>{s[l]=at}),s}const ot=rt(ge);var lt=({name:t,props:s,emits:l,injectPlugin:r})=>de({name:t,props:{...et,...s},emits:Re(l)===!0?{...ot,...l}:[...ge,...l],setup(n,{expose:u}){return tt(r,u)}});function O(t){return typeof t=="function"?t:()=>t}const nt="QUploader",st={url:[Function,String],method:{type:[Function,String],default:"POST"},fieldName:{type:[Function,String],default:()=>t=>t.name},headers:[Function,Array],formFields:[Function,Array],withCredentials:[Function,Boolean],sendRaw:[Function,Boolean],batch:[Function,Boolean],factory:Function},ut=["factoryFailed","uploaded","failed","uploading"];function it({props:t,emit:s,helpers:l}){const r=w([]),n=w([]),u=w(0),v=b(()=>({url:O(t.url),method:O(t.method),headers:O(t.headers),formFields:O(t.formFields),fieldName:O(t.fieldName),withCredentials:O(t.withCredentials),sendRaw:O(t.sendRaw),batch:O(t.batch)})),y=b(()=>u.value>0),k=b(()=>n.value.length!==0);let C;function z(){r.value.forEach(e=>{e.abort()}),n.value.length!==0&&(C=!0)}function E(){const e=l.queuedFiles.value.slice(0);l.queuedFiles.value=[],v.value.batch(e)?B(e):e.forEach(g=>{B([g])})}function B(e){if(u.value++,typeof t.factory!="function"){_(e,{});return}const g=t.factory(e);if(!g)s("factoryFailed",new Error("QUploader: factory() does not return properly"),e),u.value--;else if(typeof g.catch=="function"&&typeof g.then=="function"){n.value.push(g);const U=f=>{l.isAlive()===!0&&(n.value=n.value.filter(o=>o!==g),n.value.length===0&&(C=!1),l.queuedFiles.value=l.queuedFiles.value.concat(e),e.forEach(o=>{l.updateFileStatus(o,"failed")}),s("factoryFailed",f,e),u.value--)};g.then(f=>{C===!0?U(new Error("Aborted")):l.isAlive()===!0&&(n.value=n.value.filter(o=>o!==g),_(e,f))}).catch(U)}else _(e,g||{})}function _(e,g){const U=new FormData,f=new XMLHttpRequest,o=(i,D)=>g[i]!==void 0?O(g[i])(D):v.value[i](D),x=o("url",e);if(!x){console.error("q-uploader: invalid or no URL specified"),u.value--;return}const L=o("formFields",e);L!==void 0&&L.forEach(i=>{U.append(i.name,i.value)});let A=0,d=0,h=0,I=0,p;f.upload.addEventListener("progress",i=>{if(p===!0)return;const D=Math.min(I,i.loaded);l.uploadedSize.value+=D-h,h=D;let j=h-d;for(let T=A;j>0&&T<e.length;T++){const R=e[T];if(j>R.size)j-=R.size,A++,d+=R.size,l.updateFileStatus(R,"uploading",R.size);else{l.updateFileStatus(R,"uploading",j);return}}},!1),f.onreadystatechange=()=>{f.readyState<4||(f.status&&f.status<400?(l.uploadedFiles.value=l.uploadedFiles.value.concat(e),e.forEach(i=>{l.updateFileStatus(i,"uploaded")}),s("uploaded",{files:e,xhr:f})):(p=!0,l.uploadedSize.value-=h,l.queuedFiles.value=l.queuedFiles.value.concat(e),e.forEach(i=>{l.updateFileStatus(i,"failed")}),s("failed",{files:e,xhr:f})),u.value--,r.value=r.value.filter(i=>i!==f))},f.open(o("method",e),x),o("withCredentials",e)===!0&&(f.withCredentials=!0);const F=o("headers",e);F!==void 0&&F.forEach(i=>{f.setRequestHeader(i.name,i.value)});const P=o("sendRaw",e);e.forEach(i=>{l.updateFileStatus(i,"uploading",0),P!==!0&&U.append(o("fieldName",i),i,i.name),i.xhr=f,i.__abort=()=>{f.abort()},I+=i.size}),s("uploading",{files:e,xhr:f}),r.value.push(f),P===!0?f.send(new Blob(e)):f.send(U)}return{isUploading:y,isBusy:k,abort:z,upload:E}}var dt={name:nt,props:st,emits:ut,injectPlugin:it},ct=lt(dt);const vt="KEhx89W4ih75J6MJwZFq",ft="food-ingredients-detection-6ce7j/1",pt={detectIngredients:async t=>{try{const s=await mt(t);return(await Qe({method:"POST",url:`https://detect.roboflow.com/${ft}`,params:{api_key:vt},data:s,headers:{"Content-Type":"application/x-www-form-urlencoded"}})).data}catch(s){throw console.error("Error detecting ingredients:",s),s}}},mt=t=>new Promise((s,l)=>{const r=new FileReader;r.readAsDataURL(t),r.onload=()=>s(r.result.split(",")[1]),r.onerror=n=>l(n)}),gt={setup(){const t=w([]),s=Ve(),l=Ee();return{onImageAdded:async u=>{try{const v=u[0],y=await pt.detectIngredients(v);t.value=y.predictions}catch(v){console.error("Error detecting ingredients:",v)}},detectedIngredients:t,generateRecipe:async()=>{try{const u=t.value.map(C=>C.class);console.log("Ingredients:",u);const v=s.localStorage.getItem("userId"),y=parseInt(v);if(console.log("User ID:",y),!y)throw new Error("User is not logged in");const k=await We.post("/generate-recipe",{userId:y,ingredients:u});console.log("Recipe generated:",k.data.recipes),sessionStorage.setItem("recipes",JSON.stringify(k.data.recipes)),l.push({name:"recipes"})}catch(u){console.error("Error generating recipe:",u)}}}}},_t={key:0},ht=fe("h3",null,"Detected Ingredients:",-1);function bt(t,s,l,r,n,u){return V(),Pe(Me,{padding:""},{default:Ne(()=>[se(ct,{label:"Upload an image",onAdded:r.onImageAdded,accept:"image/*"},null,8,["onAdded"]),r.detectedIngredients.length?(V(),H("div",_t,[ht,fe("ul",null,[(V(!0),H(Oe,null,Le(r.detectedIngredients,v=>(V(),H("li",{key:v.class},De(v.class),1))),128))]),se(J,{onClick:r.generateRecipe,label:"Generate Recipe",color:"primary"},null,8,["onClick"])])):Ae("",!0)]),_:1})}var Ut=Xe(gt,[["render",bt]]);export{Ut as default};
